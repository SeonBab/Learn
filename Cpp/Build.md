# 빌드(Build)

사용자가 작성한 프로그래밍 언어로 된 소스코드(SourceCode)를 컴퓨터(CPU)가 이해할 수 있는 언어(ObjectCode)로 변환하는 작업이 필요하고, 변환하는 작업은 총 3가지 방식으로 분류할 수 있습니다. Compile 방식, Interpreter 방식, Hybrid 방식이 있습니다. C++은 Compile 방식을 사용하므로 Compile만 다루도록 하겠습니다.

# 빌드 과정

빌드 과정은 4가지 단계(전처리 - 컴파일 - 어셈블리 - 링크)로 나누어집니다.

이 4가지 단계를 묶어서 컴파일 과정, 빌드 과정이라고 부르기도 하고 컴파일 과정과 링킹 과정을 따로 나눠서 부르기도 합니다 보통 빌드 과정은 컴파일 과정보다 넓은 의미(빌드 = 컴파일 + 링킹)로 사용되기도 합니다.

![Cpp_Compile](https://user-images.githubusercontent.com/112116885/200111964-f7cdf5d5-d77f-45b4-8824-de40617dee0d.png)

# 전처리(Preprocessing)

전처리 과정은 전처리기(PreProcessor)에 의해 실행 파일을 생성하는 과정에서 컴파일하기 전, 소스코드(*.cpp)에 포함된 매크로나 [지시문](https://github.com/SeonBap/TIL/blob/main/Cpp/Preprocessor_Directives.md) 같은 텍스트를 조작하는 텍스트 처리기입니다.

이 과정에서 대표적으로 세 가지 작업을 수행합니다.

주석 제거: 소스 코드에서 주석을 제거합니다. 사용자의 필요로 인해 남긴 내용이지 컴퓨터가 알 필요는 없기 때문입니다.

헤더 파일 삽입: #include 지시문을 만나면 해당하는 헤더 파일을 찾아 헤더 파일에 있는 모든 내용을 복사해서 소스 코드에 삽입합니다. 즉,헤더 파일은 컴파일에 사용되지 않고 소스 코드 파일 내에 전부 복사됩니다. 헤더 파일에 선언된 함수 원형은 후에 링킹 과정을 통해 실제로 함수가 정의된 있는 오브젝트 파일(컴파일된 소스 코드)과 결합합니다.

매크로 치환 및 적용: #define 지시문에 정의된 매크로를 저장하고 같은 문자열을 만나면 #define 된 내용으로 치환한다. 간단하게 말해 매크로 이름을 찾아서 정의한 값으로 전부 바꿔줍니다.

# 컴파일(Compiling)

전처리된 소스코드를 번역해주는 과정입니다. 번역을 하는 이유는 컴퓨터가 0과 1로 이루어진 이진수로 작성된 기계어만을 이해할 수 있지만 개발자는 고수준 언어(high-level programming language)인 C++로 작성하는데 이렇게 되면 컴퓨터가 이해하지 못해 프로그램을 실행할 수 없습니다. 따라서 컴파일 과정에선 컴퓨터가 이해할 수 있게 번역을 하는것입니다.

번역은 저수준 언어(low-level language)로 번역되는데 저수준 언어는 일반적으로 기계어와 어셈블리어를 말하고, 일부 컴파일러들은 소스 코드를 기계어로 직접 컴파일을 하기도 하지만 어셈블리어로 컴파일이 되기도합니다. 어셈블리어를 사용해 중간 표현으로 컴파일한다면 소스 코드를 다시 읽어 들이지 않고도 나중에 실행할 것을 염두에 두고 최적화하거나 저장해 둘 수 있기 때문입니다.

C++의 경우 운영체제 별로 컴파일러가 다르기 때문에 소스코드를 각 컴파일러에 맞게 수정해야 하는 상황이 있을 수 있습니다.

위의 작업을 해주는 도구를 컴파일러(Compiler)라고 합니다.

# 어셈블(Assembling)

컴파일 단계에서 번역된 저수준 언어를 최종적으로 0과 1로 이루어진 기계어로 번역해줍니다. 이렇게 CPU가 이해할 수 있도록 0과 1로 이루어져 있는걸 오브젝트 코드라 부릅니다.

파일을 보통 오브젝트 파일(Object File)이라 부르며 이 오브젝트 파일은 특정한 파일 포맷을 가집니다.
Wiinodws의 경우 PE(Portable Executalbe), Linux의 경우ELF(Executalbe and Liking Format)로 나눠진다.

위의 작업을 해주는 도구를 어셈블러(Assembler)라고 합니다.

# 링크(Linking)

하나 이상의 오브젝트 파일과 필요한 라이브러리 파일을 합쳐 하나의 실행 가능한 파일(Executable File)로 만드는 작업을 링크(Link)라고 합니다.

흔히 어떤 프로그램을 사용할 때. exe라는 확장자를 갖는 파일을 실행시킵니다. 이 exe가 Executable의 줄임말입니다.

위의 작업을 해주는 도구를 링커(Linker)라고 합니다.