# 컴퓨터의 실수 표현

10진수 실수를 2진수로 표현 할 때 소수점을 기준으로 정수 부분은 표현하는 법이 같으며 소수 부분의 표현운 2의 음수 지수의 형태로 표현됩니다. 소수 부분의 자리 공간에 따른 값과 소수점을 기준으로 공간의 값은 아래 표와 같습니다.

![binary_num](https://github.com/geunkim/CPPLectures/raw/master/BasicProgramming/images/binary_num.png)

![binary_dec_map](https://blog.kakaocdn.net/dn/elgM3R/btq2CYAxXxR/SJgSDFH68yn0JT3WBMffQ1/img.png)

예로 10진수 0.625를 2진수로 표기하면 0.101 = 1 * 0.5 + 0 * 0.25 + 0 * 0.125입니다.

만약 10진수 0.4를 2진수로 표기하면 0.00110011...의 형태로 (0011)이 무한 반복됩니다. 즉 비트의 수가 유한한 2진수로 표현하지 못하는 수가 존재하기 때문에 컴퓨터에는 표현할 수 있는 가장 근사치 값이 저장됩니다. 근사 값을 저장하는 방법으론 두가지가 있으며 각각 고정소수점과 부동소수점입니다.


# 고정소수점(Fixed Point)

고정소수점이란 정수 부분을 표현하는 비트 수와 소수를 표현하는 비트 수를 사전에 정한 후 해당 비트 수만을 이용하여 수를 표현하는 방식입니다.
만약 정수를 표현하는 비트를 증가시키면 큰 수를 표현할 수 있으나 정밀한 수를 표현하는 것이 어려워지고, 소수를 표현하는 비트 수를 늘리면 정밀한 수를 표현할 수 있으나 큰 수를 표현할 수 없습니다.

![Fixed Point](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F998D03435C920B7718)

맨 앞 1자리는 부호 비트(Sign bit)라고 해서 0이면 양수, 1이면 음수라는 뜻입니다.

나머지 비트들은 소수점을 기준으로 정수부와 소수부를 표현하는 비트로 각각 나누게 되는데, 소수점의 위치는 미리 정해둔다. 소수부의 경우 앞에서부터 채우며 남는 뒷자리는 다 0으로 채워집니다.

구현하기 편리하지만 사용하는 비트 수 대비 표현 가능한 수의 범위 또는 정밀도가 낮기 때문에 실수를 다룰 필요가 있는 범용 시스템에서는 거의 안쓰이고, 높은 정밀도가 필요 없는 소규모 시스템에서는 간혹 쓰입니다.


# 부동소수점(Floating-point)

부동소수점이란 단어에서 부동은 소수점이 떠다닌다는 의미로 자료형 처리에 있어 소수점 위치가 바뀐다는 것이며, 영어로는 Floating-point format 입니다.
단정도와 배정도라는 말로 자료형을 구분하는데, 단정도 부동소수점 자료형은 32bit float이며 배정도 부동소수점 자료형은 64bit double을 말합니다.

수치해석용 프로그램들은 대부분 자체 자료형을 갖고 있고 숫자를 문자열 구조로 만들어 계산하여 수치 자료형의 한계를 극복합니다.

부동소수점 자료형 처리는 고정소수점 자료형 처리에 비해 복잡한 연산이 필요하므로 컴퓨터 하드웨어의 성능을 표현할 때 부동소수점 처리 능력이 빠지지 않습니다.

## IEEE 754 부동소수점 표현

![Floating-point](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99B8704C5C920A0728)

IEEE(미국의 전기 전자 기술자 협회)에서 개발한 컴퓨터에서 부동소수점을 표현하는 가장 널리 쓰이는 표준으로서 부동소수점 방식이 32비트 기준 위의 그림과 같은 구조를 가집니다.

부호비트는 고정소수점과 같으며 지수의 부호를 뜻하는게 아니라 전체 숫자의 부호를 뜻하는 것입니다.

23자리 가수부는 정규화 결과 소수점 오른쪽에 있는 숫자들을 왼쪽부터 그대로 넣으면 된다. 남는 자리는 0으로 채워집니다.

지수부에는 IEEE 표준에 따라 지수를 그대로 넣는게 아닌 bias라고 하는 지정된 숫자를 더한 다음 넣어야 합니다. 32비트를 쓰는 경우 bias는 127이라고 규정하고 있습니다.
지수부에 별개의 음수 표현을 하지 않도록 하기 위해 10진수 기준으로 1 ~ 127구간은 음수, 128~254 구간은 양수를 표현하도록 만들고 편향 값인 127을 더하게 됐습니다.

지수값 2^2=4 즉 10이기 때문에 2 + 127 = 129를 2진수로 바꾼 10000001이 들어가 위와 같은 그림의 지수가 들어가있습니다.

bias라는 값을 사용하는 이유는 지수가 음수가 될 수 있기 때문에 그렇습니다. 만약 0.000101이라는 이진수가 있다면 정규화에 대해서 설명할 때 정수부를 1로 만들어야합니다. 그러니 오른쪽으로 소수점을 밀어서 1.01*2^-4가 됩니다.

정규화라는 것은 2진수를 1.xxxx... *2^n꼴로 변환하는 것을 말합니다. 정수부에 1만 남을때까지 소수점을 왼쪽(정수부가 0일 경우엔 오른쪽)으로 이동시키고, 이동한 칸 수 만큼 n자리에 집어넣으면 됩니다.

double은 1~2045까지의 지수 표현이 가능하고 2048개의 지수 표현이 가능합니다.

각각 데이터 타입에서 0과 마지막 수는 표현 가능한 범위를 넘어서는 값을 표현하기 위해서 빠지게 되었습니다. 표현은 아래와 같습니다.

### Denormalized Number [지수부 0, 가수부 0이 아닌 수]

해당 경우는 표현할 수 있는 가장 작은 지수보다도 더 작은 경우를 의미합니다.

float의 경우 지수부에 편향 값을 취하기 전 float에서 표현할 수 있는 가장 작은 지수 값은 -127입니다. 이 때 2<sup>-127</sup>보다 더 작은 수를 의미합니다.

### Infinity [지수부 2<sup>e</sup> - 1, 가수부 0]

실수를 표현할 때, 부호 비트를 사용할 수 있는 덕분에 음의 무한과 양의 무한을 표현할 수 있게 됐습니다.

### NaN [지수부 2<sup>e</sup> - 1, 가수부 0이 아닌 수]
+∞−∞, −∞+∞, 0×∞, 0÷0, ∞÷∞처럼 값을 엄밀하게 정할 수 없는 것들을 의미합니다.